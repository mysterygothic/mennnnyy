<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฌุฑุฏ ุงููููู - ูุทุนู ููุทุจุฎ ุงูุดูุฎ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="logo.png" type="image/png">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="admin-mobile-dark.css">
    <link rel="stylesheet" href="admin-inventory.css">
    
    <!-- Chart.js for Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Security Protection - MUST be first -->
    <script src="admin-protection.js"></script>
</head>
<body class="admin-body" style="display: none;">
    <!-- Page Transition Overlay -->
    <div class="page-transition">
        <div class="page-transition-spinner"></div>
    </div>
    
    <div class="admin-container">
        <aside class="admin-sidebar">
            <div class="admin-sidebar-header">
                <img src="logo.png" alt="Logo" class="sidebar-logo">
                <h2>ุงูุฌุฑุฏ ุงููููู</h2>
            </div>
            
            <nav class="admin-nav">
                <a href="admin-dashboard.html" class="admin-nav-item">
                    <span class="nav-icon">๐</span>
                    ุฅุฏุงุฑุฉ ุงููููู
                </a>
                <a href="admin-ramadan.html" class="admin-nav-item">
                    <span class="nav-icon">๐</span>
                    ุทูุจุงุช ุฑูุถุงู
                </a>
                <a href="admin-delivery.html" class="admin-nav-item">
                    <span class="nav-icon">๐</span>
                    ุฅุฏุงุฑุฉ ุงูุชูุตูู
                </a>
                <a href="admin-driver-orders.html" class="admin-nav-item">
                    <span class="nav-icon">๐ฐ</span>
                    ุทูุจุงุช ุงูุณุงุฆููู
                </a>
                <a href="admin-customers.html" class="admin-nav-item">
                    <span class="nav-icon">๐ฅ</span>
                    ูุนูููุงุช ุงูุฒุจุงุฆู
                </a>
                <a href="admin-inventory.html" class="admin-nav-item active">
                    <span class="nav-icon">๐</span>
                    ุงูุฌุฑุฏ ุงููููู
                </a>
                <a href="admin-users.html" class="admin-nav-item">
                    <span class="nav-icon">๐</span>
                    ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
                </a>
                <a href="#" class="admin-nav-item ai-section-link">
                    <span class="nav-icon">๐ค</span>
                    AI Assistant
                    <span class="soon-badge">Soon</span>
                </a>
                <a href="#" class="admin-nav-item" onclick="adminLogout()">
                    <span class="nav-icon">๐ช</span>
                    ุชุณุฌูู ุงูุฎุฑูุฌ
                </a>
            </nav>
        </aside>

        <main class="admin-main">
            <!-- Header with Date Selector -->
            <div class="section-header">
                <h2>๐ ุงูุฌุฑุฏ ุงููููู</h2>
                <div class="header-actions">
                    <input type="date" id="inventoryDate" class="date-input">
                    <button class="btn-success" onclick="exportToExcel()">
                        ๐ฅ ุชุตุฏูุฑ Excel
                    </button>
                    <button class="btn-primary" onclick="saveInventory()">
                        ๐พ ุญูุธ ุงูุจูุงูุงุช
                    </button>
                </div>
            </div>

            <!-- Statistics Cards -->
            <div class="inventory-stats">
                <div class="stat-card sales-card">
                    <div class="stat-icon">๐ฐ</div>
                    <div class="stat-content">
                        <h3>ุฅุฌูุงูู ุงููุจูุนุงุช</h3>
                        <p class="stat-number" id="totalSalesDisplay">0.00 ุฏ.ุฃ</p>
                    </div>
                </div>
                <div class="stat-card purchases-card">
                    <div class="stat-icon">๐</div>
                    <div class="stat-content">
                        <h3>ุฅุฌูุงูู ุงููุดุชุฑูุงุช</h3>
                        <p class="stat-number" id="totalPurchasesDisplay">0.00 ุฏ.ุฃ</p>
                    </div>
                </div>
                <div class="stat-card damage-card">
                    <div class="stat-icon">โ๏ธ</div>
                    <div class="stat-content">
                        <h3>ุงูุฅุชูุงู ุงููููู</h3>
                        <p class="stat-number" id="totalDamageDisplay">0.00 ุฏ.ุฃ</p>
                    </div>
                </div>
                <div class="stat-card net-cash-card">
                    <div class="stat-icon">๐ต</div>
                    <div class="stat-content">
                        <h3>ุงูุตุงูู ุงูููุฏู</h3>
                        <p class="stat-number" id="netCashDisplay">0.00 ุฏ.ุฃ</p>
                    </div>
                </div>
                <div class="stat-card net-profit-card">
                    <div class="stat-icon">๐</div>
                    <div class="stat-content">
                        <h3>ุตุงูู ุงูุฑุจุญ</h3>
                        <p class="stat-number" id="netProfitDisplay">0.00 ุฏ.ุฃ</p>
                    </div>
                </div>
            </div>

            <!-- Average Sales Section -->
            <div class="average-section">
                <div class="average-card">
                    <div class="average-icon">๐</div>
                    <div class="average-content">
                        <h3>ูุชูุณุท ุงููุจูุนุงุช ุงูููููุฉ</h3>
                        <p class="average-number" id="averageSales">0.00 ุฏ.ุฃ</p>
                        <span class="average-subtitle" id="averageSubtitle">ุญุชู ุขุฎุฑ ููู ูุณุฌู</span>
                    </div>
                </div>
            </div>

            <!-- Data Entry Sections -->
            <div class="inventory-grid">
                <!-- Sales Section (ุฑูู ูุงุญุฏ ููุท) -->
                <div class="inventory-section sales-simple">
                    <div class="section-title">
                        <h3>๐ฐ ุงููุจูุนุงุช ุงูููููุฉ</h3>
                    </div>
                    <div class="simple-input-container">
                        <label for="totalSalesInput">ุฅุฌูุงูู ุงููุจูุนุงุช (ุฏููุงุฑ)</label>
                        <input type="number" id="totalSalesInput" class="large-number-input" min="0" step="0.5" value="0" placeholder="ูุซุงู: 6000" onchange="calculateAllTotals()">
                        <div class="input-hint">ุฃุฏุฎู ุฑูู ุงููุจูุนุงุช ุงูุฅุฌูุงูู ููููู</div>
                    </div>
                </div>

                <!-- Purchases Section -->
                <div class="inventory-section">
                    <div class="section-title">
                        <h3>๐ ุงููุดุชุฑูุงุช ุงูููููุฉ</h3>
                        <button class="btn-add" onclick="addPurchasesRow()">+ ุฅุถุงูุฉ</button>
                    </div>
                    <div class="items-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>ุงุณู ุงูุตูู</th>
                                    <th>ุงูุณุนุฑ (ุฏููุงุฑ)</th>
                                    <th>ุฅุฌุฑุงุก</th>
                                </tr>
                            </thead>
                            <tbody id="purchasesTableBody">
                                <tr class="purchases-row">
                                    <td><input type="text" class="item-name" placeholder="ูุซุงู: ูุงูู"></td>
                                    <td><input type="number" class="item-price" min="0" step="0.5" value="0" placeholder="13" onchange="calculateAllTotals()"></td>
                                    <td><button class="btn-remove" onclick="removeRow(this)">๐๏ธ</button></td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td style="text-align: left; font-weight: bold;">ุงููุฌููุน ุงูููู:</td>
                                    <td colspan="2" style="font-weight: bold; color: #ef4444;" id="purchasesTotal">0.00 ุฏ.ุฃ</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>

                <!-- Damage Section -->
                <div class="inventory-section">
                    <div class="section-title">
                        <h3>โ๏ธ ุงูุฅุชูุงู ุงููููู</h3>
                        <button class="btn-add" onclick="addDamageRow()">+ ุฅุถุงูุฉ</button>
                    </div>
                    <div class="items-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>ุงุณู ุงูุตูู</th>
                                    <th>ุงูุณุนุฑ (ุฏููุงุฑ)</th>
                                    <th>ุฅุฌุฑุงุก</th>
                                </tr>
                            </thead>
                            <tbody id="damageTableBody">
                                <tr class="damage-row">
                                    <td><input type="text" class="item-name" placeholder="ูุซุงู: ุฎุถุงุฑ ุชุงููุฉ"></td>
                                    <td><input type="number" class="item-price" min="0" step="0.5" value="0" placeholder="20" onchange="calculateAllTotals()"></td>
                                    <td><button class="btn-remove" onclick="removeRow(this)">๐๏ธ</button></td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td style="text-align: left; font-weight: bold;">ุงููุฌููุน ุงูููู:</td>
                                    <td colspan="2" style="font-weight: bold; color: #f59e0b;" id="damageTotal">0.00 ุฏ.ุฃ</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Monthly Summary Section -->
            <div class="monthly-summary-section">
                <div class="section-header">
                    <h2>๐ ุงูุฌุฑุฏ ุงูุดูุฑู</h2>
                    <div class="header-actions">
                        <select id="monthSelect" class="month-select" onchange="loadMonthlySummary()">
                            <option value="">ุงุฎุชุฑ ุงูุดูุฑ</option>
                        </select>
                        <button class="btn-success" onclick="exportMonthlyInventory()">
                            ๐ฅ ุชุตุฏูุฑ ุงูุฌุฑุฏ ุงูุดูุฑู
                        </button>
                    </div>
                </div>
                
                <div class="monthly-stats">
                    <div class="stat-card">
                        <h3>ุฅุฌูุงูู ุงููุจูุนุงุช ุงูุดูุฑูุฉ</h3>
                        <p class="stat-number" id="monthlySales">0.00 ุฏ.ุฃ</p>
                    </div>
                    <div class="stat-card">
                        <h3>ุฅุฌูุงูู ุงููุดุชุฑูุงุช ุงูุดูุฑูุฉ</h3>
                        <p class="stat-number" id="monthlyPurchases">0.00 ุฏ.ุฃ</p>
                    </div>
                    <div class="stat-card">
                        <h3>ุฅุฌูุงูู ุงูุฅุชูุงู ุงูุดูุฑู</h3>
                        <p class="stat-number" id="monthlyDamage">0.00 ุฏ.ุฃ</p>
                    </div>
                    <div class="stat-card">
                        <h3>ุตุงูู ุงูุฑุจุญ ุงูุดูุฑู</h3>
                        <p class="stat-number" id="monthlyProfit">0.00 ุฏ.ุฃ</p>
                    </div>
                </div>
            </div>

            <!-- Notes Section -->
            <div class="notes-section">
                <h3>๐ ููุงุญุธุงุช</h3>
                <textarea id="inventoryNotes" rows="4" placeholder="ุฃุถู ููุงุญุธุงุช ุนู ุงูููู..."></textarea>
            </div>

            <!-- Analytics Charts -->
            <div class="charts-section">
                <h2>๐ ุงูุชุญูููุงุช ุงูุจูุงููุฉ</h2>
                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>ุงููุจูุนุงุช vs ุงููุดุชุฑูุงุช (ุขุฎุฑ 7 ุฃูุงู)</h3>
                        <canvas id="salesPurchasesChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>ุตุงูู ุงูุฑุจุญ (ุขุฎุฑ 7 ุฃูุงู)</h3>
                        <canvas id="profitChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>ุชูุฒูุน ุงููุจูุนุงุช ูุงููุดุชุฑูุงุช ูุงูุฅุชูุงู</h3>
                        <canvas id="distributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- History Table -->
            <div class="history-section">
                <div class="section-header">
                    <h2>๐ ุณุฌู ุงูุฌุฑุฏ</h2>
                    <button class="btn-secondary" onclick="loadInventoryHistory()">๐ ุชุญุฏูุซ</button>
                </div>
                <div class="table-container">
                    <table class="ramadan-orders-table">
                        <thead>
                            <tr>
                                <th>ุงูุชุงุฑูุฎ</th>
                                <th>ุงููุจูุนุงุช</th>
                                <th>ุงููุดุชุฑูุงุช</th>
                                <th>ุงูุฅุชูุงู</th>
                                <th>ุงูุตุงูู ุงูููุฏู</th>
                                <th>ุตุงูู ุงูุฑุจุญ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody">
                            <tr>
                                <td colspan="7" class="empty-state">ูุง ููุฌุฏ ุณุฌูุงุช</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.js"></script>
    <script src="supabase-config.js"></script>
    <script src="supabase-db.js"></script>
    <script src="script.js"></script>
    <script src="admin-secure.js"></script>
    <script src="admin-mobile-dark.js"></script>
    <script src="admin-inventory-v2.js"></script>
    
    <div style="position: fixed; bottom: 10px; left: 10px; font-size: 11px; opacity: 0.6; color: #666; font-family: 'Poppins', sans-serif;">
        Coded by Zaid-Alnussirat
    </div>
</body>
</html>
